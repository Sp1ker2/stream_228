#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –ø–æ–ª–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã

echo "üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã..."

cd /Users/bogdanprihodko/Bst

# –õ–æ–∫–∞–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç
echo "   –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞..."
pkill -f "client_live.py" && echo "   ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω" || echo "   ‚ö†Ô∏è  –õ–æ–∫–∞–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω"

# –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (–µ—Å–ª–∏ –±—ã–ª –∑–∞–ø—É—â–µ–Ω)
echo "   –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞..."
pkill -f "server_simple.py" && echo "   ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω" || echo "   ‚ö†Ô∏è  –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω"

# Docker –∫–ª–∏–µ–Ω—Ç—ã
echo "   –û—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker –∫–ª–∏–µ–Ω—Ç–æ–≤..."
docker-compose down 2>&1 | grep -E "Stopping|Removing" && echo "   ‚úÖ Docker –∫–ª–∏–µ–Ω—Ç—ã –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã" || echo "   ‚ö†Ô∏è  Docker –∫–ª–∏–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"

# –£–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
echo "   –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞..."
if [ -n "$REMOTE_PASS" ]; then
    sshpass -p "$REMOTE_PASS" ssh -o StrictHostKeyChecking=no ${REMOTE_USER:-root}@${REMOTE_HOST:-195.133.17.131} 'pkill -f server_simple.py' 2>&1 && echo "   ‚úÖ –£–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω" || echo "   ‚ö†Ô∏è  –£–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω"
else
    echo "   ‚ö†Ô∏è  REMOTE_PASS –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞—é —É–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä"
fi

sleep 1

echo ""
echo "‚úÖ –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã!"
echo ""

